<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>منشئ بطاقة الموظف</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cropperjs@1.5.13/dist/cropper.min.css" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <div id="loadingOverlay" class="loading-overlay" aria-hidden="true">
        <div class="loading-box" role="status" aria-live="polite">
            <div class="spinner"></div>
            <p>جارٍ معالجة الصورة...</p>
        </div>
    </div>

    <div class="container">
        <header class="header">
            <h1>منشئ بطاقة الموظف</h1>
            <p>ارفع صورة الموظف وأدخل بياناته ليتم دمجها داخل التصميم الثابت.</p>
        </header>

        <main class="main-content">
            <section class="form-section" aria-label="نموذج بيانات الموظف">
                <h2>البيانات الأساسية</h2>
                <form id="employeeForm" novalidate>
                    <div class="form-group">
                        <label for="employeeName">اسم الموظف</label>
                        <input type="text" id="employeeName" name="employeeName" placeholder="أدخل الاسم الكامل" required />
                    </div>
                    <div class="form-group">
                        <label for="jobTitle">المسمى الوظيفي</label>
                        <input type="text" id="jobTitle" name="jobTitle" placeholder="مثال: مدير مبيعات" required />
                    </div>
                    <div class="form-group">
                        <label for="phoneNumber">رقم الهاتف</label>
                        <input type="tel" id="phoneNumber" name="phoneNumber" placeholder="05xxxxxxxx" required />
                    </div>

                    <div class="form-group image-upload">
                        <label for="employeeImage">صورة الموظف</label>
                        <div class="upload-placeholder">
                            <i class="fa-solid fa-cloud-arrow-up"></i>
                            <div>
                                <strong>اسحب وأفلت</strong>
                                <span>أو انقر لرفع صورة (PNG / JPG)</span>
                            </div>
                        </div>
                        <input type="file" id="employeeImage" name="employeeImage" accept="image/*" />
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="primary-btn">
                            <i class="fa-solid fa-id-card"></i>
                            توليد البطاقة
                        </button>
                        <button type="button" id="clearForm" class="danger-btn">
                            <i class="fa-solid fa-eraser"></i>
                            مسح البيانات
                        </button>
                    </div>
                    <div class="secondary-actions">
                        <button type="button" id="cropImage" class="outline-btn" disabled>
                            <i class="fa-solid fa-crop"></i>
                            قص الصورة
                        </button>
                    </div>
                </form>
            </section>

            <section class="preview-section" aria-label="معاينة بطاقة الموظف">
                <h2>معاينة فورية</h2>
                <div class="card-preview">
                    <div class="business-card" id="cardExportArea" role="img" aria-label="معاينة بطاقة الموظف">
                        <div class="employee-photo-container">
                            <div class="photo-placeholder">
                                <i class="fa-solid fa-user"></i>
                                <span>لم يتم اختيار صورة بعد</span>
                            </div>
                            <img id="processedImage" alt="صورة الموظف" />
                        </div>
                        <div class="employee-info-center">
                            <span class="employee-name" id="cardEmployeeName" dir="rtl" style="unicode-bidi: isolate; text-align: right;">اسم الموظف</span>
                            <span class="employee-job" id="cardJobTitle">المسمى الوظيفي</span>
                            <span class="employee-phone" id="cardPhoneNumber">رقم الهاتف</span>
                        </div>
                    </div>
                    <div class="card-actions">
                        <button type="button" id="downloadCard" class="success-btn" disabled>
                            <i class="fa-solid fa-download"></i>
                            تحميل البطاقة
                        </button>
                        <button type="button" id="shareCard" class="whatsapp-btn" disabled>
                            <i class="fa-brands fa-whatsapp"></i>
                            مشاركة عبر واتساب
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- نافذة القص -->
    <div class="cropper-modal" id="cropperModal" aria-hidden="true" role="dialog" aria-modal="true">
        <div class="cropper-dialog">
            <button type="button" class="close-cropper" id="closeCropper" aria-label="إغلاق">
                <i class="fa-solid fa-xmark"></i>
            </button>
            <h3>قص صورة الموظف</h3>
            <div class="cropper-body">
                <img id="cropperImage" alt="معاينة للقص" />
            </div>
            <div class="cropper-actions">
                <button type="button" id="cancelCrop" class="outline-btn">إلغاء</button>
                <button type="button" id="confirmCrop" class="primary-btn">حفظ القص</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/cropperjs@1.5.13/dist/cropper.min.js" defer></script>
    <script src="script.js" defer></script>
</body>
</html>
